import{g as G,h as d,i as z,o as V,c as H,d as k,a as t,w as o,F as L,b as v,k as E,l as w,t as Q}from"./index-180af58d.js";import{E as u,a as R,b as W,c as X,d as Y,g as Z}from"./el-table-column-9b9bb6ff.js";import{E as ee,a as le,b as te,c as ae}from"./el-button-b0604719.js";import{b as oe,i as ue,j as ne,k as se,l as re,E as ie,g as de}from"./survey-15302bb4.js";const ce={style:{position:"absolute",width:"1000px",left:"240px",top:"120px",padding:"20px","border-radius":"5px","border-color":"rgb(200, 200, 200)","border-width":"1px","border-style":"solid"}},pe=k("p",{style:{"margin-top":"0px","margin-left":"10px","font-weight":"600",color:"#00000072"}},"调查问卷题型表",-1),me={style:{float:"left","margin-left":"100px","margin-top":"0px","margin-bottom":"0px",color:"red"}},ye={__name:"survey_cate",setup(ve){G(()=>{f()});const c=d([]),_=d(null),p=d(0),g=d(!1),m=d(!1),n=d({id:null,cateName:""}),s=d({colums:[],current:1,size:10,total:0}),D=z(()=>p.value===0?"新增":"修改"),i=d(""),U=z(()=>c.value.slice(s.value.size*(s.value.current-1),s.value.current*s.value.size)),N=()=>{c.value=B(c.value,"id")};function B(l,e){return l.sort(function(r,b){var y=r[e],x=b[e];return y<x?-1:y>x?1:0})}const f=()=>{_.value===null?oe().then(l=>{l.success===!0?(c.value=l.data.surveyCates,s.value.total=c.value.length,N()):u.error("获取数据失败!")}).catch(l=>{console.log(l),u.error("获取数据失败!")}):ue(_.value).then(l=>{l.success===!0?(c.value=[l.data.surveyCate],s.value.total=c.value.length,N()):u.error("查询不到数据!")}).catch(l=>{console.log(l),u.error("查询不到数据!")})},T=l=>{n.value=JSON.parse(JSON.stringify(l)),p.value=1,i.value="",m.value=!0},F=l=>{ne(l.id).then(e=>{e.success===!0?(f(),u({message:"删除成功!",type:"success"})):u.error("删除失败!")}).catch(e=>{console.log(e),u.error("删除失败!")})},S=()=>{n.value={id:null,cateName:""},p.value=0,i.value="",g.value=!1,m.value=!0},I=()=>{if(i.value="",n.value.cateName===""){i.value="分类名称不能为空!";return}p.value===0?O():P()},O=()=>{g.value||(n.value.id=null),se(n.value).then(l=>{l.success===!0?(f(),m.value=!1,u({message:"添加成功!",type:"success"})):(u.error("添加失败!"),i.value="添加失败，编号或类型已存在!")}).catch(l=>{console.log(l),u.error("添加失败!"),i.value="添加失败，编号或类型已存在!"})},P=()=>{re(n.value).then(l=>{l.success===!0?(f(),m.value=!1,u({message:"修改成功!",type:"success"})):u.error("修改失败!")}).catch(l=>{console.log(l),u.error("修改失败!"),i.value="修改失败!"})},J=()=>{_.value=null,f()};return(l,e)=>{const r=ee,b=Y,y=ie,x=de,M=R,$=W,C=le,h=te,j=Z,A=ae,K=X;return V(),H(L,null,[k("div",ce,[pe,t(r,{onClick:J,type:"primary",style:{position:"absolute",right:"120px",top:"17px"}},{default:o(()=>[v("刷新")]),_:1}),t(r,{onClick:S,type:"success",style:{float:"right","margin-top":"-40px","margin-left":"-120px"}},{default:o(()=>[v("添加数据")]),_:1}),t(M,{data:U.value,border:""},{default:o(()=>[t(b,{label:"编号",prop:"id",width:"300",sortable:""}),t(b,{label:"分类名称",prop:"cateName",width:"300"}),t(b,{align:"right",width:"400"},{header:o(()=>[t(y,{controls:!1,modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=a=>_.value=a),size:"small",placeholder:"按编号查找",style:{width:"100px","margin-right":"20px"}},null,8,["modelValue"]),t(r,{size:"small",type:"primary",onClick:f},{default:o(()=>[v("搜索")]),_:1})]),default:o(a=>[t(r,{size:"small",onClick:q=>T(a.row)},{default:o(()=>[v("编辑")]),_:2},1032,["onClick"]),t(x,{title:"确认删除该记录?",onConfirm:q=>F(a.row)},{reference:o(()=>[t(r,{size:"small",type:"danger",onClick:e[1]||(e[1]=()=>{})},{default:o(()=>[v("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),t($,{onCurrentChange:e[2]||(e[2]=()=>{}),style:{float:"right","margin-top":"20px"},"page-size":s.value.size,"pager-count":11,layout:"prev, pager, next",total:s.value.total,"onUpdate:total":e[3]||(e[3]=a=>s.value.total=a),"current-page":s.value.current,"onUpdate:currentPage":e[4]||(e[4]=a=>s.value.current=a)},null,8,["page-size","total","current-page"])]),t(K,{modelValue:m.value,"onUpdate:modelValue":e[10]||(e[10]=a=>m.value=a),title:D.value,width:"30%"},{footer:o(()=>[k("span",null,[t(r,{onClick:e[9]||(e[9]=()=>{m.value=!1})},{default:o(()=>[v("取消")]),_:1}),t(r,{type:"primary",onClick:I},{default:o(()=>[v("确定")]),_:1})])]),default:o(()=>[t(A,{"label-width":"100px",style:{"max-width":"460px"}},{default:o(()=>[p.value===1?(V(),E(h,{key:0,label:"编号"},{default:o(()=>[t(C,{type:"number",disabled:"",modelValue:n.value.id,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.id=a),placeholder:"请输入编号"},null,8,["modelValue"])]),_:1})):w("",!0),t(h,{label:"分类名称"},{default:o(()=>[t(C,{modelValue:n.value.cateName,"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.cateName=a),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),p.value===0?(V(),E(h,{key:1,label:""},{default:o(()=>[t(j,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=a=>g.value=a),label:"自定义编号"},null,8,["modelValue"])]),_:1})):w("",!0),p.value===0&&g.value?(V(),E(h,{key:2,label:"编号"},{default:o(()=>[t(C,{type:"number",modelValue:n.value.id,"onUpdate:modelValue":e[8]||(e[8]=a=>n.value.id=a),placeholder:"请输入编号",clearable:""},null,8,["modelValue"])]),_:1})):w("",!0)]),_:1}),k("p",me,Q(i.value),1)]),_:1},8,["modelValue","title"])],64)}}};export{ye as default};
